{"ast":null,"code":"var _jsxFileName = \"/mnt/c/Users/Gianni/Desktop/serum-dex-ui/src/pages/TradePage.tsx\";\nimport React, { useCallback, useEffect, useRef, useState } from 'react';\nimport { Button, Col, Popover, Row, Select, Typography } from 'antd';\nimport styled from 'styled-components';\nimport UserInfoTable from '../components/UserInfoTable';\nimport StandaloneBalancesDisplay from '../components/StandaloneBalancesDisplay';\nimport { getMarketInfos, getTradePageUrl, MarketProvider, useMarket, useMarketsList, useUnmigratedDeprecatedMarkets } from '../utils/markets';\nimport TradeForm from '../components/TradeForm';\nimport LinkAddress from '../components/LinkAddress';\nimport DeprecatedMarketsInstructions from '../components/DeprecatedMarketsInstructions';\nimport { DeleteOutlined, InfoCircleOutlined, PlusCircleOutlined } from '@ant-design/icons';\nimport { notify } from '../utils/notifications';\nimport { useHistory, useParams } from 'react-router-dom';\nimport { nanoid } from 'nanoid';\nimport { TVChartContainer } from '../components/TradingView';\nconst {\n  Option,\n  OptGroup\n} = Select;\nconst Wrapper = styled.div`\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  padding: 16px 16px;\n  .borderNone .ant-select-selector {\n    border: none !important;\n  }\n`;\nexport default function TradePage() {\n  const {\n    marketAddress\n  } = useParams();\n  useEffect(() => {\n    if (marketAddress) {\n      localStorage.setItem('marketAddress', JSON.stringify(marketAddress));\n    }\n  }, [marketAddress]);\n  const history = useHistory();\n\n  function setMarketAddress(address) {\n    history.push(getTradePageUrl(address));\n  }\n\n  return /*#__PURE__*/React.createElement(MarketProvider, {\n    marketAddress: marketAddress,\n    setMarketAddress: setMarketAddress,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(TradePageInner, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }\n  }));\n}\n\nfunction TradePageInner() {\n  const {\n    market,\n    marketName,\n    customMarkets,\n    setCustomMarkets,\n    setMarketAddress\n  } = useMarket();\n  const markets = useMarketsList();\n  const [handleDeprecated, setHandleDeprecated] = useState(false);\n  const [addMarketVisible, setAddMarketVisible] = useState(false);\n  const deprecatedMarkets = useUnmigratedDeprecatedMarkets();\n  const [dimensions, setDimensions] = useState({\n    height: window.innerHeight,\n    width: window.innerWidth\n  });\n  useEffect(() => {\n    document.title = marketName ? `${marketName} â€” Serum` : 'Serum';\n  }, [marketName]);\n  const changeOrderRef = useRef();\n  useEffect(() => {\n    const handleResize = () => {\n      setDimensions({\n        height: window.innerHeight,\n        width: window.innerWidth\n      });\n    };\n\n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n  const width = dimensions === null || dimensions === void 0 ? void 0 : dimensions.width;\n  const componentProps = {\n    onChangeOrderRef: ref => changeOrderRef.current = ref,\n    onPrice: useCallback(price => changeOrderRef.current && changeOrderRef.current({\n      price\n    }), []),\n    onSize: useCallback(size => changeOrderRef.current && changeOrderRef.current({\n      size\n    }), [])\n  };\n\n  const component = (() => {\n    if (handleDeprecated) {\n      return /*#__PURE__*/React.createElement(DeprecatedMarketsPage, {\n        switchToLiveMarkets: () => setHandleDeprecated(false),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 9\n        }\n      });\n    } else if (width < 1000) {\n      return /*#__PURE__*/React.createElement(RenderSmaller, Object.assign({}, componentProps, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 14\n        }\n      }));\n    } else if (width < 1450) {\n      return /*#__PURE__*/React.createElement(RenderSmall, Object.assign({}, componentProps, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 14\n        }\n      }));\n    } else {\n      return /*#__PURE__*/React.createElement(RenderNormal, Object.assign({}, componentProps, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 14\n        }\n      }));\n    }\n  })();\n\n  const onAddCustomMarket = customMarket => {\n    const marketInfo = getMarketInfos(customMarkets).some(m => m.address.toBase58() === customMarket.address);\n\n    if (marketInfo) {\n      notify({\n        message: `A market with the given ID already exists`,\n        type: 'error'\n      });\n      return;\n    }\n\n    const newCustomMarkets = [...customMarkets, customMarket];\n    setCustomMarkets(newCustomMarkets);\n    setMarketAddress(customMarket.address);\n  };\n\n  const onDeleteCustomMarket = address => {\n    const newCustomMarkets = customMarkets.filter(m => m.address !== address);\n    setCustomMarkets(newCustomMarkets);\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Wrapper, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    align: \"middle\",\n    style: {\n      paddingLeft: 5,\n      paddingRight: 5\n    },\n    gutter: 16,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 9\n    }\n  }, market ? /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Popover, {\n    content: /*#__PURE__*/React.createElement(LinkAddress, {\n      address: market.publicKey.toBase58(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 26\n      }\n    }),\n    placement: \"bottomRight\",\n    title: \"Market address\",\n    trigger: \"click\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(InfoCircleOutlined, {\n    style: {\n      color: '#2abdd2'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 17\n    }\n  }))) : null, /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(PlusCircleOutlined, {\n    style: {\n      color: '#2abdd2'\n    },\n    onClick: () => setAddMarketVisible(true),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 13\n    }\n  })), deprecatedMarkets && deprecatedMarkets.length > 0 && /*#__PURE__*/React.createElement(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Typography, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 17\n    }\n  }, \"You have unsettled funds on old markets! Please go through them to claim your funds.\")), /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    onClick: () => setHandleDeprecated(!handleDeprecated),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 17\n    }\n  }, handleDeprecated ? 'View new markets' : 'Handle old markets')))), component));\n}\n\nfunction MarketSelector({\n  markets,\n  placeholder,\n  setHandleDeprecated,\n  customMarkets,\n  onDeleteCustomMarket\n}) {\n  var _getMarketInfos$find, _getMarketInfos$find$;\n\n  const {\n    market,\n    setMarketAddress\n  } = useMarket();\n\n  const onSetMarketAddress = marketAddress => {\n    setHandleDeprecated(false);\n    setMarketAddress(marketAddress);\n  };\n\n  const extractBase = a => a.split('/')[0];\n\n  const extractQuote = a => a.split('/')[1];\n\n  const selectedMarket = (_getMarketInfos$find = getMarketInfos(customMarkets).find(proposedMarket => (market === null || market === void 0 ? void 0 : market.address) && proposedMarket.address.equals(market.address))) === null || _getMarketInfos$find === void 0 ? void 0 : (_getMarketInfos$find$ = _getMarketInfos$find.address) === null || _getMarketInfos$find$ === void 0 ? void 0 : _getMarketInfos$find$.toBase58();\n  return /*#__PURE__*/React.createElement(Select, {\n    showSearch: true,\n    size: 'large',\n    style: {\n      width: 200\n    },\n    placeholder: placeholder || 'Select a market',\n    optionFilterProp: \"name\",\n    onSelect: onSetMarketAddress,\n    listHeight: 400,\n    value: selectedMarket,\n    filterOption: (input, option) => {\n      var _option$name;\n\n      return (option === null || option === void 0 ? void 0 : (_option$name = option.name) === null || _option$name === void 0 ? void 0 : _option$name.toLowerCase().indexOf(input.toLowerCase())) >= 0;\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 5\n    }\n  }, customMarkets && customMarkets.length > 0 && /*#__PURE__*/React.createElement(OptGroup, {\n    label: \"Custom\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 9\n    }\n  }, customMarkets.map(({\n    address,\n    name\n  }, i) => /*#__PURE__*/React.createElement(Option, {\n    value: address,\n    key: nanoid(),\n    name: name,\n    style: {\n      padding: '10px',\n      // @ts-ignore\n      backgroundColor: i % 2 === 0 ? 'rgb(39, 44, 61)' : null\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 247,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    flex: \"auto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 17\n    }\n  }, name), selectedMarket !== address && /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 250,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(DeleteOutlined, {\n    onClick: e => {\n      e.stopPropagation();\n      e.nativeEvent.stopImmediatePropagation();\n      onDeleteCustomMarket && onDeleteCustomMarket(address);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 251,\n      columnNumber: 21\n    }\n  })))))), /*#__PURE__*/React.createElement(OptGroup, {\n    label: \"Markets\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 265,\n      columnNumber: 7\n    }\n  }, markets.sort((a, b) => extractQuote(a.name) === 'USDT' && extractQuote(b.name) !== 'USDT' ? -1 : extractQuote(a.name) !== 'USDT' && extractQuote(b.name) === 'USDT' ? 1 : 0).sort((a, b) => extractBase(a.name) < extractBase(b.name) ? -1 : extractBase(a.name) > extractBase(b.name) ? 1 : 0).map(({\n    address,\n    name,\n    deprecated\n  }, i) => /*#__PURE__*/React.createElement(Option, {\n    value: address.toBase58(),\n    key: nanoid(),\n    name: name,\n    style: {\n      padding: '10px',\n      // @ts-ignore\n      backgroundColor: i % 2 === 0 ? 'rgb(39, 44, 61)' : null\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 283,\n      columnNumber: 13\n    }\n  }, name, \" \", deprecated ? ' (Deprecated)' : null))));\n}\n\nconst DeprecatedMarketsPage = ({\n  switchToLiveMarkets\n}) => {\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 304,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    flex: \"auto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 305,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(DeprecatedMarketsInstructions, {\n    switchToLiveMarkets: switchToLiveMarkets,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 306,\n      columnNumber: 11\n    }\n  }))));\n};\n\nconst RenderNormal = ({\n  onChangeOrderRef,\n  onPrice,\n  onSize\n}) => {\n  return /*#__PURE__*/React.createElement(Row, {\n    style: {\n      minHeight: '900px',\n      flexWrap: 'nowrap'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 317,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    flex: \"auto\",\n    style: {\n      height: '50vh'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 323,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    style: {\n      height: '100%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 324,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(TVChartContainer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 325,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(Row, {\n    style: {\n      height: '70%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 327,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(UserInfoTable, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 328,\n      columnNumber: 11\n    }\n  }))), /*#__PURE__*/React.createElement(Col, {\n    flex: \"400px\",\n    style: {\n      height: '100%',\n      display: 'flex',\n      flexDirection: 'column'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 331,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(TradeForm, {\n    setChangeOrderRef: onChangeOrderRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 335,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(StandaloneBalancesDisplay, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 336,\n      columnNumber: 9\n    }\n  })));\n};\n\nconst RenderSmall = ({\n  onChangeOrderRef,\n  onPrice,\n  onSize\n}) => {\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Row, {\n    style: {\n      height: '30vh'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 345,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(TVChartContainer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 346,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(Row, {\n    style: {\n      height: '900px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 348,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    flex: \"400px\",\n    style: {\n      height: '100%',\n      display: 'flex',\n      flexDirection: 'column'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 353,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(TradeForm, {\n    setChangeOrderRef: onChangeOrderRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 357,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(StandaloneBalancesDisplay, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 358,\n      columnNumber: 11\n    }\n  }))), /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 361,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    flex: \"auto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 362,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(UserInfoTable, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 363,\n      columnNumber: 11\n    }\n  }))));\n};\n\nconst RenderSmaller = ({\n  onChangeOrderRef,\n  onPrice,\n  onSize\n}) => {\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Row, {\n    style: {\n      height: '50vh'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 373,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(TVChartContainer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 374,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 376,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    xs: 24,\n    sm: 12,\n    style: {\n      height: '100%',\n      display: 'flex'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 377,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(TradeForm, {\n    style: {\n      flex: 1\n    },\n    setChangeOrderRef: onChangeOrderRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 378,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(Col, {\n    xs: 24,\n    sm: 12,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 380,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(StandaloneBalancesDisplay, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 381,\n      columnNumber: 11\n    }\n  }))), /*#__PURE__*/React.createElement(Row, {\n    style: {\n      height: '500px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 384,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 391,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    flex: \"auto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 392,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(UserInfoTable, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 393,\n      columnNumber: 11\n    }\n  }))));\n};","map":{"version":3,"sources":["/mnt/c/Users/Gianni/Desktop/serum-dex-ui/src/pages/TradePage.tsx"],"names":["React","useCallback","useEffect","useRef","useState","Button","Col","Popover","Row","Select","Typography","styled","UserInfoTable","StandaloneBalancesDisplay","getMarketInfos","getTradePageUrl","MarketProvider","useMarket","useMarketsList","useUnmigratedDeprecatedMarkets","TradeForm","LinkAddress","DeprecatedMarketsInstructions","DeleteOutlined","InfoCircleOutlined","PlusCircleOutlined","notify","useHistory","useParams","nanoid","TVChartContainer","Option","OptGroup","Wrapper","div","TradePage","marketAddress","localStorage","setItem","JSON","stringify","history","setMarketAddress","address","push","TradePageInner","market","marketName","customMarkets","setCustomMarkets","markets","handleDeprecated","setHandleDeprecated","addMarketVisible","setAddMarketVisible","deprecatedMarkets","dimensions","setDimensions","height","window","innerHeight","width","innerWidth","document","title","changeOrderRef","handleResize","addEventListener","removeEventListener","componentProps","onChangeOrderRef","ref","current","onPrice","price","onSize","size","component","onAddCustomMarket","customMarket","marketInfo","some","m","toBase58","message","type","newCustomMarkets","onDeleteCustomMarket","filter","paddingLeft","paddingRight","publicKey","color","length","MarketSelector","placeholder","onSetMarketAddress","extractBase","a","split","extractQuote","selectedMarket","find","proposedMarket","equals","input","option","name","toLowerCase","indexOf","map","i","padding","backgroundColor","e","stopPropagation","nativeEvent","stopImmediatePropagation","sort","b","deprecated","DeprecatedMarketsPage","switchToLiveMarkets","RenderNormal","minHeight","flexWrap","display","flexDirection","RenderSmall","RenderSmaller","flex"],"mappings":"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","sourcesContent":["import React, { useCallback, useEffect, useRef, useState } from 'react';\nimport { Button, Col, Popover, Row, Select, Typography } from 'antd';\nimport styled from 'styled-components';\nimport UserInfoTable from '../components/UserInfoTable';\nimport StandaloneBalancesDisplay from '../components/StandaloneBalancesDisplay';\nimport {\n  getMarketInfos,\n  getTradePageUrl,\n  MarketProvider,\n  useMarket,\n  useMarketsList,\n  useUnmigratedDeprecatedMarkets,\n} from '../utils/markets';\nimport TradeForm from '../components/TradeForm';\nimport LinkAddress from '../components/LinkAddress';\nimport DeprecatedMarketsInstructions from '../components/DeprecatedMarketsInstructions';\nimport {\n  DeleteOutlined,\n  InfoCircleOutlined,\n  PlusCircleOutlined,\n} from '@ant-design/icons';\nimport CustomMarketDialog from '../components/CustomMarketDialog';\nimport { notify } from '../utils/notifications';\nimport { useHistory, useParams } from 'react-router-dom';\nimport { nanoid } from 'nanoid';\nimport { TVChartContainer } from '../components/TradingView';\n\nconst { Option, OptGroup } = Select;\n\nconst Wrapper = styled.div`\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  padding: 16px 16px;\n  .borderNone .ant-select-selector {\n    border: none !important;\n  }\n`;\n\nexport default function TradePage() {\n  const { marketAddress } = useParams();\n  useEffect(() => {\n    if (marketAddress) {\n      localStorage.setItem('marketAddress', JSON.stringify(marketAddress));\n    }\n  }, [marketAddress]);\n  const history = useHistory();\n  function setMarketAddress(address) {\n    history.push(getTradePageUrl(address));\n  }\n\n  return (\n    <MarketProvider\n      marketAddress={marketAddress}\n      setMarketAddress={setMarketAddress}\n    >\n      <TradePageInner />\n    </MarketProvider>\n  );\n}\n\nfunction TradePageInner() {\n  const {\n    market,\n    marketName,\n    customMarkets,\n    setCustomMarkets,\n    setMarketAddress,\n  } = useMarket();\n  const markets = useMarketsList();\n  const [handleDeprecated, setHandleDeprecated] = useState(false);\n  const [addMarketVisible, setAddMarketVisible] = useState(false);\n  const deprecatedMarkets = useUnmigratedDeprecatedMarkets();\n  const [dimensions, setDimensions] = useState({\n    height: window.innerHeight,\n    width: window.innerWidth,\n  });\n\n  useEffect(() => {\n    document.title = marketName ? `${marketName} â€” Serum` : 'Serum';\n  }, [marketName]);\n\n  const changeOrderRef = useRef<\n    ({ size, price }: { size?: number; price?: number }) => void\n  >();\n\n  useEffect(() => {\n    const handleResize = () => {\n      setDimensions({\n        height: window.innerHeight,\n        width: window.innerWidth,\n      });\n    };\n\n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  const width = dimensions?.width;\n  const componentProps = {\n    onChangeOrderRef: (ref) => (changeOrderRef.current = ref),\n    onPrice: useCallback(\n      (price) => changeOrderRef.current && changeOrderRef.current({ price }),\n      [],\n    ),\n    onSize: useCallback(\n      (size) => changeOrderRef.current && changeOrderRef.current({ size }),\n      [],\n    ),\n  };\n  const component = (() => {\n    if (handleDeprecated) {\n      return (\n        <DeprecatedMarketsPage\n          switchToLiveMarkets={() => setHandleDeprecated(false)}\n        />\n      );\n    } else if (width < 1000) {\n      return <RenderSmaller {...componentProps} />;\n    } else if (width < 1450) {\n      return <RenderSmall {...componentProps} />;\n    } else {\n      return <RenderNormal {...componentProps} />;\n    }\n  })();\n\n  const onAddCustomMarket = (customMarket) => {\n    const marketInfo = getMarketInfos(customMarkets).some(\n      (m) => m.address.toBase58() === customMarket.address,\n    );\n    if (marketInfo) {\n      notify({\n        message: `A market with the given ID already exists`,\n        type: 'error',\n      });\n      return;\n    }\n    const newCustomMarkets = [...customMarkets, customMarket];\n    setCustomMarkets(newCustomMarkets);\n    setMarketAddress(customMarket.address);\n  };\n\n  const onDeleteCustomMarket = (address) => {\n    const newCustomMarkets = customMarkets.filter((m) => m.address !== address);\n    setCustomMarkets(newCustomMarkets);\n  };\n\n  return (\n    <>\n      <Wrapper>\n        <Row\n          align=\"middle\"\n          style={{ paddingLeft: 5, paddingRight: 5 }}\n          gutter={16}\n        >\n          {market ? (\n            <Col>\n              <Popover\n                content={<LinkAddress address={market.publicKey.toBase58()} />}\n                placement=\"bottomRight\"\n                title=\"Market address\"\n                trigger=\"click\"\n              >\n                <InfoCircleOutlined style={{ color: '#2abdd2' }} />\n              </Popover>\n            </Col>\n          ) : null}\n          <Col>\n            <PlusCircleOutlined\n              style={{ color: '#2abdd2' }}\n              onClick={() => setAddMarketVisible(true)}\n            />\n          </Col>\n          {deprecatedMarkets && deprecatedMarkets.length > 0 && (\n            <React.Fragment>\n              <Col>\n                <Typography>\n                  You have unsettled funds on old markets! Please go through\n                  them to claim your funds.\n                </Typography>\n              </Col>\n              <Col>\n                <Button onClick={() => setHandleDeprecated(!handleDeprecated)}>\n                  {handleDeprecated ? 'View new markets' : 'Handle old markets'}\n                </Button>\n              </Col>\n            </React.Fragment>\n          )}\n        </Row>\n        {component}\n      </Wrapper>\n    </>\n  );\n}\n\nfunction MarketSelector({\n  markets,\n  placeholder,\n  setHandleDeprecated,\n  customMarkets,\n  onDeleteCustomMarket,\n}) {\n  const { market, setMarketAddress } = useMarket();\n\n  const onSetMarketAddress = (marketAddress) => {\n    setHandleDeprecated(false);\n    setMarketAddress(marketAddress);\n  };\n\n  const extractBase = (a) => a.split('/')[0];\n  const extractQuote = (a) => a.split('/')[1];\n\n  const selectedMarket = getMarketInfos(customMarkets)\n    .find(\n      (proposedMarket) =>\n        market?.address && proposedMarket.address.equals(market.address),\n    )\n    ?.address?.toBase58();\n\n  return (\n    <Select\n      showSearch\n      size={'large'}\n      style={{ width: 200 }}\n      placeholder={placeholder || 'Select a market'}\n      optionFilterProp=\"name\"\n      onSelect={onSetMarketAddress}\n      listHeight={400}\n      value={selectedMarket}\n      filterOption={(input, option) =>\n        option?.name?.toLowerCase().indexOf(input.toLowerCase()) >= 0\n      }\n    >\n      {customMarkets && customMarkets.length > 0 && (\n        <OptGroup label=\"Custom\">\n          {customMarkets.map(({ address, name }, i) => (\n            <Option\n              value={address}\n              key={nanoid()}\n              name={name}\n              style={{\n                padding: '10px',\n                // @ts-ignore\n                backgroundColor: i % 2 === 0 ? 'rgb(39, 44, 61)' : null,\n              }}\n            >\n              <Row>\n                <Col flex=\"auto\">{name}</Col>\n                {selectedMarket !== address && (\n                  <Col>\n                    <DeleteOutlined\n                      onClick={(e) => {\n                        e.stopPropagation();\n                        e.nativeEvent.stopImmediatePropagation();\n                        onDeleteCustomMarket && onDeleteCustomMarket(address);\n                      }}\n                    />\n                  </Col>\n                )}\n              </Row>\n            </Option>\n          ))}\n        </OptGroup>\n      )}\n      <OptGroup label=\"Markets\">\n        {markets\n          .sort((a, b) =>\n            extractQuote(a.name) === 'USDT' && extractQuote(b.name) !== 'USDT'\n              ? -1\n              : extractQuote(a.name) !== 'USDT' &&\n                extractQuote(b.name) === 'USDT'\n              ? 1\n              : 0,\n          )\n          .sort((a, b) =>\n            extractBase(a.name) < extractBase(b.name)\n              ? -1\n              : extractBase(a.name) > extractBase(b.name)\n              ? 1\n              : 0,\n          )\n          .map(({ address, name, deprecated }, i) => (\n            <Option\n              value={address.toBase58()}\n              key={nanoid()}\n              name={name}\n              style={{\n                padding: '10px',\n                // @ts-ignore\n                backgroundColor: i % 2 === 0 ? 'rgb(39, 44, 61)' : null,\n              }}\n            >\n              {name} {deprecated ? ' (Deprecated)' : null}\n            </Option>\n          ))}\n      </OptGroup>\n    </Select>\n  );\n}\n\nconst DeprecatedMarketsPage = ({ switchToLiveMarkets }) => {\n  return (\n    <>\n      <Row>\n        <Col flex=\"auto\">\n          <DeprecatedMarketsInstructions\n            switchToLiveMarkets={switchToLiveMarkets}\n          />\n        </Col>\n      </Row>\n    </>\n  );\n};\n\nconst RenderNormal = ({ onChangeOrderRef, onPrice, onSize }) => {\n  return (\n    <Row\n      style={{\n        minHeight: '900px',\n        flexWrap: 'nowrap',\n      }}\n    >\n      <Col flex=\"auto\" style={{ height: '50vh' }}>\n        <Row style={{ height: '100%' }}>\n          <TVChartContainer />\n        </Row>\n        <Row style={{ height: '70%' }}>\n          <UserInfoTable />\n        </Row>\n      </Col>\n      <Col\n        flex=\"400px\"\n        style={{ height: '100%', display: 'flex', flexDirection: 'column' }}\n      >\n        <TradeForm setChangeOrderRef={onChangeOrderRef} />\n        <StandaloneBalancesDisplay />\n      </Col>\n    </Row>\n  );\n};\n\nconst RenderSmall = ({ onChangeOrderRef, onPrice, onSize }) => {\n  return (\n    <>\n      <Row style={{ height: '30vh' }}>\n        <TVChartContainer />\n      </Row>\n      <Row\n        style={{\n          height: '900px',\n        }}\n      >\n        <Col\n          flex=\"400px\"\n          style={{ height: '100%', display: 'flex', flexDirection: 'column' }}\n        >\n          <TradeForm setChangeOrderRef={onChangeOrderRef} />\n          <StandaloneBalancesDisplay />\n        </Col>\n      </Row>\n      <Row>\n        <Col flex=\"auto\">\n          <UserInfoTable />\n        </Col>\n      </Row>\n    </>\n  );\n};\n\nconst RenderSmaller = ({ onChangeOrderRef, onPrice, onSize }) => {\n  return (\n    <>\n      <Row style={{ height: '50vh' }}>\n        <TVChartContainer />\n      </Row>\n      <Row>\n        <Col xs={24} sm={12} style={{ height: '100%', display: 'flex' }}>\n          <TradeForm style={{ flex: 1 }} setChangeOrderRef={onChangeOrderRef} />\n        </Col>\n        <Col xs={24} sm={12}>\n          <StandaloneBalancesDisplay />\n        </Col>\n      </Row>\n      <Row\n        style={{\n          height: '500px',\n        }}\n      >\n\n      </Row>\n      <Row>\n        <Col flex=\"auto\">\n          <UserInfoTable />\n        </Col>\n      </Row>\n    </>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}