{"ast":null,"code":"var _jsxFileName = \"/mnt/c/Users/Gianni/Desktop/serum-dex-ui/src/components/UserInfoTable/WalletBalancesTable.tsx\";\nimport React, { useState } from 'react';\nimport DataTable from '../layout/DataTable';\nimport { Button, Row } from 'antd';\nimport { settleAllFunds } from '../../utils/send';\nimport { notify } from '../../utils/notifications';\nimport { useConnection } from '../../utils/connection';\nimport { useWallet } from '../../utils/wallet';\nimport { useAllMarkets, useSelectedTokenAccounts, useTokenAccounts } from '../../utils/markets';\nimport StandaloneTokenAccountsSelect from '../StandaloneTokenAccountSelect';\nimport { abbreviateAddress } from '../../utils/utils';\nimport { PublicKey } from '@solana/web3.js';\nexport default function WalletBalancesTable({\n  walletBalances\n}) {\n  const connection = useConnection();\n  const {\n    wallet,\n    connected\n  } = useWallet();\n  const [selectedTokenAccounts] = useSelectedTokenAccounts();\n  const [tokenAccounts, tokenAccountsConnected] = useTokenAccounts();\n  const [allMarkets, allMarketsConnected] = useAllMarkets();\n  const [settlingFunds, setSettlingFunds] = useState(false);\n\n  async function onSettleFunds() {\n    setSettlingFunds(true);\n\n    try {\n      if (!wallet) {\n        notify({\n          message: 'Wallet not connected',\n          description: 'Wallet not connected',\n          type: 'error'\n        });\n        return;\n      }\n\n      if (!tokenAccounts || !tokenAccountsConnected) {\n        notify({\n          message: 'Error settling funds',\n          description: 'TokenAccounts not connected',\n          type: 'error'\n        });\n        return;\n      }\n\n      if (!allMarkets || !allMarketsConnected) {\n        notify({\n          message: 'Error settling funds',\n          description: 'Markets not connected',\n          type: 'error'\n        });\n        return;\n      }\n\n      await settleAllFunds({\n        connection,\n        tokenAccounts,\n        selectedTokenAccounts,\n        wallet,\n        markets: allMarkets.map(marketInfo => marketInfo.market)\n      });\n    } catch (e) {\n      notify({\n        message: 'Error settling funds',\n        description: e.message,\n        type: 'error'\n      });\n    } finally {\n      setSettlingFunds(false);\n    }\n  }\n\n  const columns = [{\n    title: 'Coin',\n    key: 'coin',\n    width: '20%',\n    render: walletBalance => /*#__PURE__*/React.createElement(Row, {\n      align: \"middle\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"a\", {\n      href: `https://solscan.io/address/${walletBalance.mint}`,\n      target: '_blank',\n      rel: \"noopener noreferrer\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 11\n      }\n    }, walletBalance.coin || abbreviateAddress(new PublicKey(walletBalance.mint))))\n  }, {\n    title: 'Wallet Balance',\n    dataIndex: 'walletBalance',\n    key: 'walletBalance',\n    width: '20%'\n  }, {\n    title: 'Open orders total balances',\n    dataIndex: 'openOrdersTotal',\n    key: 'openOrdersTotal',\n    width: '20%'\n  }, {\n    title: 'Unsettled balances',\n    dataIndex: 'openOrdersFree',\n    key: 'openOrdersFree',\n    width: '20%'\n  }, {\n    title: 'Selected token account',\n    key: 'selectTokenAccount',\n    width: '20%',\n    render: walletBalance => /*#__PURE__*/React.createElement(Row, {\n      align: \"middle\",\n      style: {\n        width: '430px'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(StandaloneTokenAccountsSelect, {\n      accounts: tokenAccounts === null || tokenAccounts === void 0 ? void 0 : tokenAccounts.filter(t => t.effectiveMint.toBase58() === walletBalance.mint),\n      mint: walletBalance.mint,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 11\n      }\n    }))\n  }];\n  return /*#__PURE__*/React.createElement(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(DataTable, {\n    emptyLabel: \"No balances\",\n    dataSource: walletBalances,\n    columns: columns,\n    pagination: false,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 7\n    }\n  }), connected && /*#__PURE__*/React.createElement(Button, {\n    onClick: onSettleFunds,\n    loading: settlingFunds,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 9\n    }\n  }, \"Settle all funds\"));\n}","map":{"version":3,"sources":["/mnt/c/Users/Gianni/Desktop/serum-dex-ui/src/components/UserInfoTable/WalletBalancesTable.tsx"],"names":["React","useState","DataTable","Button","Row","settleAllFunds","notify","useConnection","useWallet","useAllMarkets","useSelectedTokenAccounts","useTokenAccounts","StandaloneTokenAccountsSelect","abbreviateAddress","PublicKey","WalletBalancesTable","walletBalances","connection","wallet","connected","selectedTokenAccounts","tokenAccounts","tokenAccountsConnected","allMarkets","allMarketsConnected","settlingFunds","setSettlingFunds","onSettleFunds","message","description","type","markets","map","marketInfo","market","e","columns","title","key","width","render","walletBalance","mint","coin","dataIndex","filter","t","effectiveMint","toBase58"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport DataTable from '../layout/DataTable';\nimport { Button, Row } from 'antd';\nimport { settleAllFunds } from '../../utils/send';\nimport { notify } from '../../utils/notifications';\nimport { useConnection } from '../../utils/connection';\nimport { useWallet } from '../../utils/wallet';\nimport {\n  useAllMarkets,\n  useSelectedTokenAccounts,\n  useTokenAccounts,\n} from '../../utils/markets';\nimport StandaloneTokenAccountsSelect from '../StandaloneTokenAccountSelect';\nimport { abbreviateAddress } from '../../utils/utils';\nimport { PublicKey } from '@solana/web3.js';\n\nexport default function WalletBalancesTable({\n  walletBalances,\n}: {\n  walletBalances: {\n    coin: string;\n    mint: string;\n    walletBalance: number;\n    openOrdersFree: number;\n    openOrdersTotal: number;\n  }[];\n}) {\n  const connection = useConnection();\n  const { wallet, connected } = useWallet();\n  const [selectedTokenAccounts] = useSelectedTokenAccounts();\n  const [tokenAccounts, tokenAccountsConnected] = useTokenAccounts();\n  const [allMarkets, allMarketsConnected] = useAllMarkets();\n  const [settlingFunds, setSettlingFunds] = useState(false);\n\n  async function onSettleFunds() {\n    setSettlingFunds(true);\n    try {\n      if (!wallet) {\n        notify({\n          message: 'Wallet not connected',\n          description: 'Wallet not connected',\n          type: 'error',\n        });\n        return;\n      }\n\n      if (!tokenAccounts || !tokenAccountsConnected) {\n        notify({\n          message: 'Error settling funds',\n          description: 'TokenAccounts not connected',\n          type: 'error',\n        });\n        return;\n      }\n      if (!allMarkets || !allMarketsConnected) {\n        notify({\n          message: 'Error settling funds',\n          description: 'Markets not connected',\n          type: 'error',\n        });\n        return;\n      }\n      await settleAllFunds({\n        connection,\n        tokenAccounts,\n        selectedTokenAccounts,\n        wallet,\n        markets: allMarkets.map((marketInfo) => marketInfo.market),\n      });\n    } catch (e) {\n      notify({\n        message: 'Error settling funds',\n        description: e.message,\n        type: 'error',\n      });\n    } finally {\n      setSettlingFunds(false);\n    }\n  }\n\n  const columns = [\n    {\n      title: 'Coin',\n      key: 'coin',\n      width: '20%',\n      render: (walletBalance) => (\n        <Row align=\"middle\">\n          <a\n            href={`https://solscan.io/address/${walletBalance.mint}`}\n            target={'_blank'}\n            rel=\"noopener noreferrer\"\n          >\n            {walletBalance.coin ||\n              abbreviateAddress(new PublicKey(walletBalance.mint))}\n          </a>\n        </Row>\n      ),\n    },\n    {\n      title: 'Wallet Balance',\n      dataIndex: 'walletBalance',\n      key: 'walletBalance',\n      width: '20%',\n    },\n    {\n      title: 'Open orders total balances',\n      dataIndex: 'openOrdersTotal',\n      key: 'openOrdersTotal',\n      width: '20%',\n    },\n    {\n      title: 'Unsettled balances',\n      dataIndex: 'openOrdersFree',\n      key: 'openOrdersFree',\n      width: '20%',\n    },\n    {\n      title: 'Selected token account',\n      key: 'selectTokenAccount',\n      width: '20%',\n      render: (walletBalance) => (\n        <Row align=\"middle\" style={{ width: '430px' }}>\n          <StandaloneTokenAccountsSelect\n            accounts={tokenAccounts?.filter(\n              (t) => t.effectiveMint.toBase58() === walletBalance.mint,\n            )}\n            mint={walletBalance.mint}\n          />\n        </Row>\n      ),\n    },\n  ];\n  return (\n    <React.Fragment>\n      <DataTable\n        emptyLabel=\"No balances\"\n        dataSource={walletBalances}\n        columns={columns}\n        pagination={false}\n      />\n      {connected && (\n        <Button onClick={onSettleFunds} loading={settlingFunds}>\n          Settle all funds\n        </Button>\n      )}\n    </React.Fragment>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}