{"ast":null,"code":"var _jsxFileName = \"/mnt/c/Users/Gianni/Desktop/serum-dex-ui/src/components/StandaloneBalancesDisplay.tsx\";\nimport { Button, Row } from 'antd';\nimport React, { useState } from 'react';\nimport FloatingElement from './layout/FloatingElement';\nimport styled from 'styled-components';\nimport { useBalances, useMarket, useSelectedBaseCurrencyAccount, useSelectedOpenOrdersAccount, useSelectedQuoteCurrencyAccount, useTokenAccounts } from '../utils/markets';\nimport { useWallet } from '../utils/wallet';\nimport { settleFunds } from '../utils/send';\nimport { useSendConnection } from '../utils/connection';\nimport { notify } from '../utils/notifications';\nimport { useInterval } from '../utils/useInterval';\nimport { useLocalStorageState } from '../utils/utils';\nimport { AUTO_SETTLE_DISABLED_OVERRIDE } from '../utils/preferences';\nimport { useReferrer } from '../utils/referrer';\nconst RowBox = styled(Row)`\n  padding-bottom: 20px;\n`;\nconst Tip = styled.p`\n  font-size: 12px;\n  padding-top: 6px;\n`;\nconst ActionButton = styled(Button)`\n  color: #2abdd2;\n  background-color: #212734;\n  border-width: 0px;\n`;\nexport default function StandaloneBalancesDisplay() {\n  const {\n    baseCurrency,\n    quoteCurrency,\n    market\n  } = useMarket();\n  const balances = useBalances();\n  const openOrdersAccount = useSelectedOpenOrdersAccount(true);\n  const connection = useSendConnection();\n  const {\n    providerUrl,\n    providerName,\n    wallet,\n    connected\n  } = useWallet();\n  const [baseOrQuote, setBaseOrQuote] = useState('');\n  const baseCurrencyAccount = useSelectedBaseCurrencyAccount();\n  const quoteCurrencyAccount = useSelectedQuoteCurrencyAccount();\n  const [tokenAccounts] = useTokenAccounts();\n  const baseCurrencyBalances = balances && balances.find(b => b.coin === baseCurrency);\n  const quoteCurrencyBalances = balances && balances.find(b => b.coin === quoteCurrency);\n  const [autoSettleEnabled] = useLocalStorageState('autoSettleEnabled', true);\n  const [lastSettledAt, setLastSettledAt] = useState(0);\n  const {\n    usdcRef,\n    usdtRef\n  } = useReferrer();\n\n  async function onSettleFunds() {\n    if (!wallet) {\n      notify({\n        message: 'Wallet not connected',\n        description: 'wallet is undefined',\n        type: 'error'\n      });\n      return;\n    }\n\n    if (!market) {\n      notify({\n        message: 'Error settling funds',\n        description: 'market is undefined',\n        type: 'error'\n      });\n      return;\n    }\n\n    if (!openOrdersAccount) {\n      notify({\n        message: 'Error settling funds',\n        description: 'Open orders account is undefined',\n        type: 'error'\n      });\n      return;\n    }\n\n    if (!baseCurrencyAccount) {\n      notify({\n        message: 'Error settling funds',\n        description: 'Open orders account is undefined',\n        type: 'error'\n      });\n      return;\n    }\n\n    if (!quoteCurrencyAccount) {\n      notify({\n        message: 'Error settling funds',\n        description: 'Open orders account is undefined',\n        type: 'error'\n      });\n      return;\n    }\n\n    try {\n      await settleFunds({\n        market,\n        openOrders: openOrdersAccount,\n        connection,\n        wallet,\n        baseCurrencyAccount,\n        quoteCurrencyAccount,\n        usdcRef,\n        usdtRef\n      });\n    } catch (e) {\n      notify({\n        message: 'Error settling funds',\n        description: e.message,\n        type: 'error'\n      });\n    }\n  }\n\n  useInterval(() => {\n    const autoSettle = async () => {\n      if (AUTO_SETTLE_DISABLED_OVERRIDE || !wallet || !market || !openOrdersAccount || !baseCurrencyAccount || !quoteCurrencyAccount || !autoSettleEnabled) {\n        return;\n      }\n\n      if (!(baseCurrencyBalances === null || baseCurrencyBalances === void 0 ? void 0 : baseCurrencyBalances.unsettled) && !(quoteCurrencyBalances === null || quoteCurrencyBalances === void 0 ? void 0 : quoteCurrencyBalances.unsettled)) {\n        return;\n      }\n\n      if (Date.now() - lastSettledAt < 15000) {\n        return;\n      }\n\n      try {\n        console.log('Settling funds...');\n        setLastSettledAt(Date.now());\n        await settleFunds({\n          market,\n          openOrders: openOrdersAccount,\n          connection,\n          wallet,\n          baseCurrencyAccount,\n          quoteCurrencyAccount,\n          usdcRef,\n          usdtRef\n        });\n      } catch (e) {\n        console.log('Error auto settling funds: ' + e.message);\n        return;\n      }\n\n      console.log('Finished settling funds.');\n    };\n\n    connected && (wallet === null || wallet === void 0 ? void 0 : wallet.autoApprove) && autoSettleEnabled && autoSettle();\n  }, 1000);\n  const formattedBalances = [[baseCurrency, baseCurrencyBalances, 'base', market === null || market === void 0 ? void 0 : market.baseMintAddress.toBase58()], [quoteCurrency, quoteCurrencyBalances, 'quote', market === null || market === void 0 ? void 0 : market.quoteMintAddress.toBase58()]];\n  return /*#__PURE__*/React.createElement(FloatingElement, {\n    style: {\n      flex: 1,\n      paddingTop: 10\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 7\n    }\n  }, \"Aca Historial\"));\n}","map":{"version":3,"sources":["/mnt/c/Users/Gianni/Desktop/serum-dex-ui/src/components/StandaloneBalancesDisplay.tsx"],"names":["Button","Row","React","useState","FloatingElement","styled","useBalances","useMarket","useSelectedBaseCurrencyAccount","useSelectedOpenOrdersAccount","useSelectedQuoteCurrencyAccount","useTokenAccounts","useWallet","settleFunds","useSendConnection","notify","useInterval","useLocalStorageState","AUTO_SETTLE_DISABLED_OVERRIDE","useReferrer","RowBox","Tip","p","ActionButton","StandaloneBalancesDisplay","baseCurrency","quoteCurrency","market","balances","openOrdersAccount","connection","providerUrl","providerName","wallet","connected","baseOrQuote","setBaseOrQuote","baseCurrencyAccount","quoteCurrencyAccount","tokenAccounts","baseCurrencyBalances","find","b","coin","quoteCurrencyBalances","autoSettleEnabled","lastSettledAt","setLastSettledAt","usdcRef","usdtRef","onSettleFunds","message","description","type","openOrders","e","autoSettle","unsettled","Date","now","console","log","autoApprove","formattedBalances","baseMintAddress","toBase58","quoteMintAddress","flex","paddingTop"],"mappings":"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","sourcesContent":["import { Button, Col, Divider, Popover, Row } from 'antd';\nimport React, { useState } from 'react';\nimport FloatingElement from './layout/FloatingElement';\nimport styled from 'styled-components';\nimport {\n  useBalances,\n  useMarket,\n  useSelectedBaseCurrencyAccount,\n  useSelectedOpenOrdersAccount,\n  useSelectedQuoteCurrencyAccount,\n  useTokenAccounts,\n} from '../utils/markets';\nimport DepositDialog from './DepositDialog';\nimport { useWallet } from '../utils/wallet';\nimport Link from './Link';\nimport { settleFunds } from '../utils/send';\nimport { useSendConnection } from '../utils/connection';\nimport { notify } from '../utils/notifications';\nimport { Balances } from '../utils/types';\nimport StandaloneTokenAccountsSelect from './StandaloneTokenAccountSelect';\nimport LinkAddress from './LinkAddress';\nimport { InfoCircleOutlined } from '@ant-design/icons';\nimport { useInterval } from '../utils/useInterval';\nimport { useLocalStorageState } from '../utils/utils';\nimport { AUTO_SETTLE_DISABLED_OVERRIDE } from '../utils/preferences';\nimport { useReferrer } from '../utils/referrer';\n\nconst RowBox = styled(Row)`\n  padding-bottom: 20px;\n`;\n\nconst Tip = styled.p`\n  font-size: 12px;\n  padding-top: 6px;\n`;\n\nconst ActionButton = styled(Button)`\n  color: #2abdd2;\n  background-color: #212734;\n  border-width: 0px;\n`;\n\nexport default function StandaloneBalancesDisplay() {\n  const { baseCurrency, quoteCurrency, market } = useMarket();\n  const balances = useBalances();\n  const openOrdersAccount = useSelectedOpenOrdersAccount(true);\n  const connection = useSendConnection();\n  const { providerUrl, providerName, wallet, connected } = useWallet();\n  const [baseOrQuote, setBaseOrQuote] = useState('');\n  const baseCurrencyAccount = useSelectedBaseCurrencyAccount();\n  const quoteCurrencyAccount = useSelectedQuoteCurrencyAccount();\n  const [tokenAccounts] = useTokenAccounts();\n  const baseCurrencyBalances =\n    balances && balances.find((b) => b.coin === baseCurrency);\n  const quoteCurrencyBalances =\n    balances && balances.find((b) => b.coin === quoteCurrency);\n  const [autoSettleEnabled] = useLocalStorageState('autoSettleEnabled', true);\n  const [lastSettledAt, setLastSettledAt] = useState<number>(0);\n  const { usdcRef, usdtRef } = useReferrer();\n  async function onSettleFunds() {\n    if (!wallet) {\n      notify({\n        message: 'Wallet not connected',\n        description: 'wallet is undefined',\n        type: 'error',\n      });\n      return;\n    }\n\n    if (!market) {\n      notify({\n        message: 'Error settling funds',\n        description: 'market is undefined',\n        type: 'error',\n      });\n      return;\n    }\n    if (!openOrdersAccount) {\n      notify({\n        message: 'Error settling funds',\n        description: 'Open orders account is undefined',\n        type: 'error',\n      });\n      return;\n    }\n    if (!baseCurrencyAccount) {\n      notify({\n        message: 'Error settling funds',\n        description: 'Open orders account is undefined',\n        type: 'error',\n      });\n      return;\n    }\n    if (!quoteCurrencyAccount) {\n      notify({\n        message: 'Error settling funds',\n        description: 'Open orders account is undefined',\n        type: 'error',\n      });\n      return;\n    }\n\n    try {\n      await settleFunds({\n        market,\n        openOrders: openOrdersAccount,\n        connection,\n        wallet,\n        baseCurrencyAccount,\n        quoteCurrencyAccount,\n        usdcRef,\n        usdtRef,\n      });\n    } catch (e) {\n      notify({\n        message: 'Error settling funds',\n        description: e.message,\n        type: 'error',\n      });\n    }\n  }\n\n  useInterval(() => {\n    const autoSettle = async () => {\n      if (\n        AUTO_SETTLE_DISABLED_OVERRIDE ||\n        !wallet ||\n        !market ||\n        !openOrdersAccount ||\n        !baseCurrencyAccount ||\n        !quoteCurrencyAccount ||\n        !autoSettleEnabled\n      ) {\n        return;\n      }\n      if (\n        !baseCurrencyBalances?.unsettled &&\n        !quoteCurrencyBalances?.unsettled\n      ) {\n        return;\n      }\n      if (Date.now() - lastSettledAt < 15000) {\n        return;\n      }\n      try {\n        console.log('Settling funds...');\n        setLastSettledAt(Date.now());\n        await settleFunds({\n          market,\n          openOrders: openOrdersAccount,\n          connection,\n          wallet,\n          baseCurrencyAccount,\n          quoteCurrencyAccount,\n          usdcRef,\n          usdtRef,\n        });\n      } catch (e) {\n        console.log('Error auto settling funds: ' + e.message);\n        return;\n      }\n      console.log('Finished settling funds.');\n    };\n    connected && wallet?.autoApprove && autoSettleEnabled && autoSettle();\n  }, 1000);\n\n  const formattedBalances: [\n    string | undefined,\n    Balances | undefined,\n    string,\n    string | undefined,\n  ][] = [\n    [\n      baseCurrency,\n      baseCurrencyBalances,\n      'base',\n      market?.baseMintAddress.toBase58(),\n    ],\n    [\n      quoteCurrency,\n      quoteCurrencyBalances,\n      'quote',\n      market?.quoteMintAddress.toBase58(),\n    ],\n  ];\n\n  return (\n    <FloatingElement style={{ flex: 1, paddingTop: 10 }}>\n      <h1>Aca Historial</h1>\n    </FloatingElement>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}